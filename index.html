<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <link rel="stylesheet" href="css/style.css">
    <title>Čobanac</title>
</head>

<body>
    <nav>
        <div class="container">
            <div class="container2">
                <img src="images/cobanac_logo.jpg" width="110">
                <h2>Čobanac</h2>
            </div>

            <div class="menu">
                <a href="index.html" class="is-active">Početna</a>
                <a href="o_cobancu.html" class="is-inactive">O čobancu</a>
            </div>
        </div>
    </nav>

    <form class="form-group-form" style="text-align: center;">
        <label for="number">Unesite broj osoba za koje želite praviti čobanac:</label>
        <input type="number" id="number" min="5" max="100" name="number" required>
    </form>

    <div class="form-group-button" style="text-align: center">
        <button onclick="prikaziSastojke()" class="button" id="toggle_sastojci">Prikaži/Sakrij sastojke</button>
    </div>

    <div class="row">
        <div class="card" id="sastojci" style="display: none;">
            <h2 id="sastojci_h2">Potrebni sastojci</h2>
            <img class="card_image" src="images/sastojci.jfif">
            <p id="sastojci_p"> 
                Unesite broj osoba za izračun potrebnih sastojaka!
            </p>
        </div>
    </div>

    <div id="pie" style="text-align: center"></div>

    <script>
        var data = 
        [{"naziv" : "srnetina", "vrijednost" : 158},
        {"naziv" : "junetina", "vrijednost" : 142},
        {"naziv" : "svinjetina", "vrijednost" : 161},
        {"naziv" : "luk", "vrijednost" : 40},
        {"naziv" : "mrkva", "vrijednost" : 42},
        {"naziv" : "peršin", "vrijednost" : 55},
        {"naziv" : "celer", "vrijednost" : 23},
        {"naziv" : "mljevena paprika", "vrijednost" : 282},
        {"naziv" : "svinjska mast", "vrijednost" : 885},
        {"naziv" : "pasirana rajčica", "vrijednost" : 25}
        ];

        var margin = {
            top: 40,
            bottom: 70,
            left: 100,
            right: 20
        };
        var width = 500 - margin.left - margin.right;
        var height = 500 - margin.top - margin.bottom;
        var barPadding = 10;
        var barWidth = width / data.length - barPadding;

        var x = d3.scale.ordinal()
            .domain(d3.range(data.length))
            .rangeRoundBands([0, width]);

        var y = d3.scale.linear()
            .domain([0, d3.max(data, function(d) {
                return d.vrijednost;
            })])
            .range([height, 0]);

        var svg = d3.select("#pie")
            .append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.bottom + margin.top)
            .style("background-color", "transparent")
            .append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        var xAxis = d3.svg.axis()
            .scale(x)
            .orient("bottom")
            .tickFormat(function(d, i) {
                return "";
            });

        var yAxis = d3.svg.axis()
            .scale(y)
            .orient("left")
            .ticks(10);

        var colors = d3.scale.ordinal()
            .domain(data - 1)
            .range(["#FE1C1C", "#FE751C", "#FEED1C", "#A8FE1C", "#1CFE31",
                "#1CFECB", "#1CB6FE", "#1C49FE", "#5D1CFE", "#D51CFE", "#FFFFFF", "#000000"
            ]);

        svg.append("g")
            .attr("class", "x axis")
            .attr("transform", "translate(0," + height + ")")
            .call(xAxis)
            .selectAll("text")
            .style("text-anchor", "middle");
        svg.append("text")
            .attr("x", (width / 2))
            .attr("y", -(margin.top / 2))
            .attr("font-weight", "bold")
            .style("font-size", "20px")
            .style("text-anchor", "middle")
            .text("Kalorijska vrijednost na 100g");
        svg.append("g")
            .attr("class", "y axis")
            .call(yAxis)
            .append("text")
            .attr("transform", "rotate(-90)")
            .attr("x", -(height / 2))
            .attr("y", -((margin.left / 2) + 20))
            .style("text-anchor", "middle")
            .style("font-size", "20px")
            .text("Kcal")
        svg.append("text")
            .attr("x", (width / 2))
            .attr("y", (height + (margin.bottom / 2)))
            .attr("dy", "1em")
            .style("text-anchor", "middle")
            .style("font-size", "20px")
            .text("Sastojak");

        var barchart = svg.selectAll("rect")
            .data(data)
            .enter()
            .append("rect")
            .attr("x", function(d, i) {
                return x(i);
            })
            .attr("y", function(d, i) {
                return y(d.vrijednost);
            })
            .attr("height", function(d) {
                return height - y(d.vrijednost);
            })
            .attr("width", barWidth)
            .attr("fill", function(d, i) {
                return colors(i);
            });
    </script>


    <div class="form-group-button" style="text-align: center">
        <button onclick="prikaziPostupak()" class="button" id="toggle_postupak">Prikaži/Sakrij postupak</button>
    </div>

    <div class="row">
        <div class="card" id="postupak" style="display: none;">
            <h2>Postupak</h2>
            <img class="card_image" src="images/postupak.jpeg">
            <h3>Priprema</h3>
            <p> 
                 - sitno isjeckati ili izblendati luk 
                <br> - naribati ili izblendati mrkvu, korjen peršina i korjen celera
                <br> - svo meso narezati na kockice jednake veličine
            </p>
            <h3><br>Postupak kuhanja</h3>
            <p>
                - 
            </p>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <h2>Čobanac</h2>
            <img src="images/cobanac_logo.jpg" alt="logo" width="150">
            <p>Copyright &copy; 2022 Petar Ivanković</p>
        </div>
    </footer>
</body>

<script>
    function prikaziSastojke(){
        var num = document.getElementById("number").value;
        var nog, rajcica, mast;
        var p = document.getElementById("sastojci_p");
        if(num.length != 0){
            if(num >=5 && num <=15) nog = 1, rajcica = 0.1, mast = 1;
            else if(num >= 16 && num <=30) nog = 2, rajcica = 0.2, mast = 2;
            else if(num >= 31 && num <=45) nog = 3, rajcica = 0.3, mast = 3;
            else if(num >= 46 && num <=60) nog = 4, rajcica = 0.4, mast = 4;
            else if(num >= 61 && num <=75) nog = 5, rajcica = 0.5, mast = 5;
            else if(num >= 76) nog = 6, rajcica = 0.6, mast = 6;

            var h2 = document.getElementById("sastojci_h2");
            h2.innerHTML = "Potrebni sastojci za " + num + " osoba";
            var mesokg = Number((num*250)/1000).toFixed(2);

            //p element potrebnih sastojaka
            p.innerHTML = "- " + mesokg + " kg mesa (" + Number(0.3*mesokg).toFixed(2) + " kg divljači, " + 
            Number(0.3*mesokg).toFixed(2) + " kg junetine, " + Number(0.4*mesokg).toFixed(2) + " kg svinjetine)"
            + "<br>" + "- " + Number(mesokg/3).toFixed(2) + " kg luka" + "<br>" + "- " + Number((mesokg/3)/3).toFixed(2) + " kg korjenastog povrća ("
            + Number(((mesokg/3)/3)*0.6).toFixed(2) + " kg mrkve, " + Number(((mesokg/3)/3)*0.25).toFixed(2)
            + " kg peršina, " + Number(((mesokg/3)/3)*0.15).toFixed(2) + " kg celera)" + "<br>"
            + "- " + nog + " svinjska/ih nogica" + "<br>" + "- " + Number(mesokg*3).toFixed(2) + " g papra"
            + "<br>" + "- " + Number(mesokg*20).toFixed(2) + " g soli" + "<br>" + "- " + Number(mesokg*3).toFixed(2)
            + " g ljute paprike" + "<br>" + "- " + Number(mesokg*15).toFixed(2) + " g slatke paprike"
            + "<br>" + "- " + Number(num/5).toFixed(0) + " lovorov/a list/a"
            + "<br>" + "- " + Number((num/2)+(0.25*(num/2))).toFixed(2) + " L vode (" 
            + Number(((num/2)+(0.25*(num/2)))*0.125).toFixed(2) + " L mineralne vode)"
            + "<br>" + "- " + rajcica + " L pasirane rajčice" + "<br>" + "- " + mast + " žlica/e svinjske masti";

            if(num < 5) { 
                p.innerHTML = "Broj osoba za izračun potrebnih sastojaka mora biti veći ili jednak 5!";
                h2.innerHTML = "Potrebni sastojci";
            }
        }

        var x = document.getElementById("sastojci");
        if (x.style.display === "none") {
            x.style.display = "block";
        } else {
            x.style.display = "none";
        }
    }
    function prikaziPostupak(){
        var x = document.getElementById("postupak");
        if (x.style.display === "none") {
            x.style.display = "block";
        } else {
            x.style.display = "none";
        }
    }

</script>

</html>
